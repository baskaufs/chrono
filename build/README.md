## Generating the "normative document"

The script `generate_normative_csv.py` pulls source data from the [rs.tdwg.org](http://github.com/tdwg/rs.tdwg.org) repository. The local file `qrg-list.csv` contains a list of the term IRIs in the order that they are to appear in the Quick Reference Guide. This list needs to be changed whenever terms are added to or deprecated from Darwin Core.

It generates the file `term_versions.csv`, which is used as the input for the `build.py` script below.

# Build script

The build script `build.py` uses as input:

- [vocabulary/term_versions.csv](../vocabulary/term_versions.csv): the list of terms
- [terms.tmpl](terms.tmpl): a Jinja2 template for the Quick Reference Guide

And creates:

- The Quick Reference Guide is a Markdown file at [docs/terms/index.md](../docs/terms/index.md). The guide is built as Markdown (with a lot of included html) rather than html, so it can be incorporated by Jekyll in the Darwin Core website (including a header, footer and table of contents).
- Two simple Darwin Core CSV files in [dist/](../dist/)

## Run the build script

1. Install the required libraries (once):

    ```bash
    pip install -r requirements.txt
    ```

2. Run the script from the command line:

    ```bash
    python build.py
    ```

## Generating the "list of terms" document

Prior to building the production List of Terms document, the Python script "update_previous_doc.py" must be run to change the headers of the previous version of the document and to rename that previous version to a dated version. This must be done first, otherwise the previous index.md file will be overwritten by the new one that is generated by the build-termlist.py script. NOTE: The vocabulary and document metadata in the rs.tdwg.org repository must have been updated before running this script. See <https://github.com/tdwg/rs.tdwg.org/blob/master/process/process-vocabulary.md> for details. Command line arguments are:

`--slug` (required): the last part of the document URL actual document URL (not the permanent IRI) before the trailing slash. For the Chronometric Age Extension List of Terms, this is `list`.

`--dir` (required): the subdirectory of the `process/document_metadata_processing/` directory in the rs.tdwg.org repository where the `author_metadata.yaml` and `document_metadata.yaml` files are located. For the Humboldt Extension List of Terms, this is `dwc_doc_chrono`.

`--branch` (optional): the branch of the rs.tdwg.org repository where the metadata are located. The default is `master`.

The Python script `build-termlist.py` inputs the header information from `termlist-header.md`, then builds the list of terms and their metadata from data in the [rs.tdwg.org](http://github.com/tdwg/rs.tdwg.org) repository. It dynamically inserts document metadata from YAML files in a [directory in the rs.tdwg.org repo](https://github.com/tdwg/rs.tdwg.org/tree/master/process/document_metadata_processing/dwc_doc_chrono). These files should be updated if author or document metadata has changed. The script also inputs `termlist-footer.md` and appends it to the end of the generated document, but currently it has no content. The constructed Markdown document is saved as `/docs/list/index.md`. 

Run the script from the command line:

```
python build-termlist.py
```
